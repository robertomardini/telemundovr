<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Estadio VR con A-Frame y HLS (HTTPS)</title>
    <meta name="description" content="Estadio VR con transmisión en vivo HLS vía HTTPS" />
    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <!-- HLS.js para reproducir .m3u8 en navegadores -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
      /* 1) Ocultar el <video> sin usar display:none */
      #videoLive {
        position: absolute;
        width: 1px;
        height: 1px;
        opacity: 0;
        pointer-events: none;
      }

      /* 2) Ajustes para los botones de A-Frame VR y pantalla completa */
      .a-enter-vr-button,
      .a-fullscreen-button {
        position: fixed !important;
        /* Zona segura o margen de 10px */
        top: env(safe-area-inset-top, 10px) !important;
        left: env(safe-area-inset-left, 10px) !important;
        /* Tamaño reducido y uniforme */
        width: 40px !important;
        height: 40px !important;
        min-width: 40px !important;
        min-height: 40px !important;
        padding: 0 !important;
        margin: 0 !important;
        font-size: 12px !important;
        line-height: 40px !important;
        border-radius: 4px !important;
        z-index: 9999 !important;
      }
      /* Separar el botón de pantalla completa hacia la derecha */
      .a-fullscreen-button {
        left: calc(env(safe-area-inset-left, 10px) + 50px) !important;
      }
    </style>
  </head>

  <body>
    <!-- Elemento de video oculto: será la fuente de la pantalla en A-Frame -->
    <video
      id="videoLive"
      autoplay
      muted
      playsinline
      webkit-playsinline
      crossorigin="anonymous"
    ></video>

    <!-- Escena A-Frame -->
    <a-scene vr-mode-ui="enabled: true" embedded>
      <!-- Cámara VR a 1.6 m de altura -->
      <a-entity position="0 1.6 0">
        <a-camera look-controls wasd-controls-enabled="false"></a-camera>
      </a-entity>

      <!-- Suelo del estadio -->
      <a-plane rotation="-90 0 0" width="100" height="100" color="#2e2e2e"></a-plane>

      <!-- Pantalla de video en vivo -->
      <a-video src="#videoLive" width="16" height="9" position="0 4 -15"></a-video>

      <!-- Gradas del estadio (medio cilindro) -->
      <a-cylinder
        position="0 5 -15"
        radius="30"
        height="10"
        color="#444"
        side="double"
        segments-radial="64"
        open-ended="true"
        theta-length="180"
      ></a-cylinder>

      <!-- Iluminación -->
      <a-light type="ambient" intensity="1"></a-light>
      <a-light type="directional" intensity="0.5" position="0 10 0"></a-light>
    </a-scene>

    <!-- Script para cargar el stream HLS vía HTTPS -->
    <script>
      var video = document.getElementById('videoLive');
      // Stream HLS seguro por HTTPS (tráiler “Sintel” de Bitmovin)
      var videoSrc =
        'https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8';

      if (Hls.isSupported()) {
        var hls = new Hls();
        hls.loadSource(videoSrc);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, function () {
          video.play();
        });
      } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = videoSrc;
        video.addEventListener('loadedmetadata', function () {
          video.play();
        });
      }
    </script>
  </body>
</html>
