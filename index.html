<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>VR Stadium – Gradas y Pantalla Curva</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
    </style>
  </head>
  <body>
    <a-scene embedded vr-mode-ui="enabled: true">
      <!-- Cámara / posición de espectador -->
      <a-entity position="0 1.6 0">
        <a-camera wasd-controls="enabled: false"></a-camera>
      </a-entity>

      <!-- Suelo plano bajo las gradas -->
      <a-plane rotation="-90 0 0" width="100" height="100" color="#222"></a-plane>

      <!-- Gradas: cilindro segmentado de 90° -->
      <a-cylinder
        position="0 2 -5"
        rotation="0 180 0"
        radius="8"
        height="4"
        open-ended="true"
        side="double"
        theta-length="90"
        material="color: #555; opacity: 0.9"
      ></a-cylinder>

      <!-- Asientos: varios pequeños cubos en filas -->
      <a-entity id="asientos">
        <!-- Generamos 5 filas, 10 asientos por fila -->
        <a-entity position="0 0 -5">
          <a-entity
            id="fila0" position="0 0.5 0"
            template="row:0"
          ></a-entity>
        </a-entity>
      </a-entity>

      <!-- Pantalla curva: segmento de cilindro enfrentado al espectador -->
      <a-cylinder
        position="0 3 -10"
        rotation="0 180 0"
        radius="10"
        height="6"
        open-ended="true"
        theta-length="90"
        material="shader: flat; src: #videoTexture"
      ></a-cylinder>

      <!-- Fuente de video (oculta) -->
      <video id="videoLive" autoplay loop crossorigin="anonymous" src="https://live-hls-web-aje.getaj.net/AJE/index.m3u8"></video>
      <a-assets>
        <video id="videoTexture" src="#videoLive"></video>
      </a-assets>

      <!-- Luces -->
      <a-light type="ambient" intensity="0.6"></a-light>
      <a-light type="directional" intensity="0.8" position="0 10 -5"></a-light>
    </a-scene>

    <script>
      // Script para generar asientos en filas
      const filas = 5, asientosPorFila = 10;
      const separacionX = 1.5, separacionZ = 0.8;
      const entidadAsientos = document.querySelector('#asientos');

      for (let fila = 0; fila < filas; fila++) {
        for (let i = 0; i < asientosPorFila; i++) {
          const seat = document.createElement('a-box');
          seat.setAttribute('depth', '0.5');
          seat.setAttribute('width', '0.5');
          seat.setAttribute('height', '0.3');
          seat.setAttribute('material', 'color:#333');
          // posicionamos cada asiento en semicírculo
          const angle = -45 + (90 / (asientosPorFila - 1)) * i;
          const rad = THREE.Math.degToRad(angle);
          const x = Math.sin(rad) * (8 + 0.4);      // radio + offset
          const z = -5 + Math.cos(rad) * (8 + 0.4);
          // elevamos según la fila
          const y = 0.3 + fila * 0.4;
          seat.setAttribute('position', `${x} ${y} ${z}`);
          entidadAsientos.appendChild(seat);
        }
      }
    </script>
    <!-- A-Frame depende de THREE, expuesto en window -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  </body>
</html>
